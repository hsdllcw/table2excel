<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hello GitHub!</title>
    <script type="text/javascript" src="jquery-1.12.4.js"></script>
    <script type="text/javascript" src="base64.min.js" charset="utf-8"></script>
</head>

<body>
    <table id="customers">
        <thead>
            <tr>
                <th>国家</th>
                <th>Population</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Chinna</td>
                <td>1,363,480,000</td>
                <td>March 24, 2014</td>
            </tr>
            <tr>
                <td>India</td>
                <td>1,241,900,000</td>
                <td>March 24, 2014</td>
            </tr>
            <tr>
                <td>United States</td>
                <td>317,746,000</td>
                <td>March 24, 2014</td>
            </tr>
            <tr>
                <td>Indonesia</td>
                <td>249,866,000</td>
                <td>July 1, 2013</td>
            </tr>
            <tr>
                <td>Brazil</td>
                <td>201,032,714</td>
                <td>July 1, 2013</td>
            </tr>
        </tbody>
    </table>
    <button onclick="table2excel(customers)">下载</button>
</body>
<script>
    function table2excel(tableName) {
        var el = $(tableName);
        var excel = "<table>";
        $(el).find('thead').find('tr').each(function() {
            excel += "<tr>";
            $(this).filter(':visible').find('th').each(function(index, data) {
                if ($(this).css('display') != 'none') {
                    excel += "<td>" + $(this).text() + "</td>";
                }
            });
            excel += '</tr>';
        });
        var rowCount = 1;
        $(el).find('tbody').find('tr').each(function() {
            excel += "<tr>";
            var colCount = 0;
            $(this).filter(':visible').find('td').each(function(index, data) {
                if ($(this).css('display') != 'none') {
                    excel += "<td>" + $(this).text() + "</td>";
                }
                colCount++;
            });
            rowCount++;
            excel += '</tr>';
        });
        excel += '</table>'
        var excelFile = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";
        excelFile += "<head>";
        excelFile += "<!--[if gte mso 9]>";
        excelFile += "<xml>";
        excelFile += "<x:ExcelWorkbook>";
        excelFile += "<x:ExcelWorksheets>";
        excelFile += "<x:ExcelWorksheet>";
        excelFile += "<x:Name>";
        excelFile += "{worksheet}";
        excelFile += "</x:Name>";
        excelFile += "<x:WorksheetOptions>";
        excelFile += "<x:DisplayGridlines/>";
        excelFile += "</x:WorksheetOptions>";
        excelFile += "</x:ExcelWorksheet>";
        excelFile += "</x:ExcelWorksheets>";
        excelFile += "</x:ExcelWorkbook>";
        excelFile += "</xml>";
        excelFile += "<![endif]-->";
        excelFile += "</head>";
        excelFile += "<body>";
        excelFile += excel;
        excelFile += "</body>";
        excelFile += "</html>";
        window.open('data:application/vnd.ms-excel;filename=exportData.doc;base64,' + Base64.encode(excelFile));
    }
</script>

</html>